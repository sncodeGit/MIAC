# -*- coding: utf-8 -*-
"""
Взяли рез-таты repeated_with_null и посчитали у каждой пары столбцов, в скольких строчках они одновременно не принимают значение null
@author: PapernyukAlex
"""
import pandas as pd
import numpy as np

mass = [('IdCase1', 'IdCase2'), ('IdCase1', 'IdCase3'), ('IdCase1', 'IdCase4'), ('IdCase1', 'IdCase'), ('IdPerson1', 'IdPerson2'), ('IdCasePaymentType', 'IdPaymentType2'), ('IdCasePaymentType', 'IdRCasePaymentType'), ('IdCasePaymentType', 'IdReferralType'), ('IdCasePaymentType', 'Active_l1'), ('IdCasePaymentType', 'Active_l2'), ('IdCasePaymentType', 'Parent_Id'), ('IdCaseAidType', 'IdReferralType'), ('IdCaseAidType', 'Active_l1'), ('IdCaseAidType', 'Active_l2'), ('IdCaseAidType', 'IdTraumaType'), ('IdCaseAidType', 'IdRTraumaType2'), ('IdCaseAidType', 'IdRTraumaType1'), ('IdCaseType1', 'IdRDiagnosisChangeReason'), ('IdCaseType1', 'IdCaseType2'), ('IdCaseResult1', 'IdCaseResult2'), ('IdCaseResult1', 'IdReferralType'), ('IdCaseResult1', 'Active_l1'), ('IdCaseResult1', 'Active_l2'), ('IDDoctor1', 'IdRefDepartmentHead'), ('IdLpu1', 'IdTargetLpu'), ('IdLpu1', 'IdLpu4'), ('IdCase2', 'IdCase4'), ('IdCase2', 'IdCase'), ('IdCasePurpose', 'IdTraumaType'), ('IdCasePurpose', 'IdRTraumaType2'), ('IdCasePurpose', 'IdRDisabilityDocReason'), ('IdCasePurpose', 'IsPatient'), ('IdCasePurpose', 'IdRTraumaType1'), ('IdCase3', 'IdCase4'), ('IdCase3', 'IdCase'), ('IdPatientConditionOnAdmission', 'IdReferralType'), ('IdPatientConditionOnAdmission', 'Active_l1'), ('IdPatientConditionOnAdmission', 'Active_l2'), ('IdPatientConditionOnAdmission', 'IdRDisabilityDocReason'), ('IdPatientConditionOnAdmission', 'IsPatient'), ('IdTypeFromDiseaseStart1', 'IdReferralType'), ('IdTypeFromDiseaseStart1', 'Active_l1'), ('IdTypeFromDiseaseStart1', 'Active_l2'), ('IdTypeFromDiseaseStart1', 'IdTypeFromDiseaseStart2'), ('IDHospResult', 'IdReferralType'), ('IDHospResult', 'Active_l1'), ('IDHospResult', 'Active_l2'), ('IDHospResult', 'IdRHospResult'), ('IDHospResult', 'IdRDisabilityDocReason'), ('IDHospResult', 'IsPatient'), ('IDTransportIntern', 'IdPersonRole'), ('IdHospChannel', 'IdHospitalizationOrder2'), ('IdHospChannel', 'IdComponent_l2'), ('IdRHospitalizationPrimacy1', 'IdReferralType'), ('IdRHospitalizationPrimacy1', 'Active_l1'), ('IdRHospitalizationPrimacy1', 'Active_l2'), ('IdRHospitalizationPrimacy1', 'IdRHospitalizationPrimacy2'), ('IdRHospitalizationPrimacy1', 'IdRDisabilityDocReason'), ('IdRHospitalizationPrimacy1', 'IsPatient'), ('IdHospitalizationOrder1', 'IdHospitalizationOrder2'), ('IdHospitalizationOrder1', 'IdComponent_l2'), ('IdHospitalizationOrder1', 'IdRHospitalizationOrder'), ('IdHospitalizationOrder1', 'IdRDisabilityDocStatus'), ('IdStep1', 'IdStep2'), ('IdStep1', 'IdStep3'), ('IdStep1', 'IdStep4'), ('IdStep1', 'IdStep5'), ('IdStep1', 'IdStep6'), ('IdStep1', 'IdStep7'), ('IDDoctor2', 'IDDoctor3'), ('IDDoctor2', 'IDDoctor5'), ('IdCase4', 'IdCase'), ('IdPaymentType1', 'Parent_Id'), ('IdStep2', 'IdStep5'), ('IdStep2', 'IdStep6'), ('IdStep2', 'IdStep7'), ('IdStep3', 'IdStep5'), ('IdStep3', 'IdStep6'), ('IdStep3', 'IdStep7'), ('IdVisitPlace', 'IdRVisitPlace'), ('IdVisitPurpose', 'IdRVisitPurpose'), ('IdPaymentType2', 'IdRCasePaymentType'), ('IdPaymentType2', 'IdReferralType'), ('IdPaymentType2', 'Active_l1'), ('IdPaymentType2', 'Active_l2'), ('IdPaymentType2', 'Parent_Id'), ('IdAddress1', 'IdAddress2'), ('IdRCasePaymentType', 'IdReferralType'), ('IdRCasePaymentType', 'Active_l1'), ('IdRCasePaymentType', 'Active_l2'), ('IdRCasePaymentType', 'Parent_Id'), ('IDDoctor3', 'IDDoctor5'), ('IdSpeciality1', 'IdSpeciality2'), ('IdCaseResult2', 'IdReferralType'), ('IdCaseResult2', 'Active_l1'), ('IdCaseResult2', 'Active_l2'), ('IdMedDocument2', 'IdMedDocument3'), ('IdMedDocument2', 'IdMedDocument4'), ('IdMedDocument2', 'IdMedDocument_sl'), ('CreationDate2', 'IssuedDateTime'), ('IDDoctor4', 'IdRefDepartmentHead'), ('IdMedDocumentType1', 'IdMedDocumentType2'), ('IdStep4', 'IdStep5'), ('IdDocumentMis', 'IdReferralMIS'), ('MkbCode_r', 'MkbCode_diag'), ('IdReferralType', 'Active_l1'), ('IdReferralType', 'Active_l2'), ('IdReferralType', 'IdRHospitalizationPrimacy2'), ('IdReferralType', 'IdTypeFromDiseaseStart2'), ('IdReferralType', 'IdDiagnosisType1'), ('IdReferralType', 'IdDiagnosisType2'), ('IdReferralType', 'IdRHospResult'), ('IdReferralType', 'Hosp'),
('IdReferralType', 'Adult'), ('IdRefDepartmentHead', 'IdDiagnosedDoctor'), ('IdHospitalizationOrder2', 'IdComponent_l2'), ('IdHospitalizationOrder2', 'IdRHospitalizationOrder'), ('IdSourceLpu', 'IdLpu3'), ('IdTargetLpu', 'IdLpu4'), ('Active_l1', 'Active_l2'), ('Active_l1', 'IdRHospitalizationPrimacy2'), ('Active_l1', 'IdTypeFromDiseaseStart2'), ('Active_l1', 'IdDiagnosisType1'), ('Active_l1', 'IdDiagnosisType2'), ('Active_l1', 'IdRHospResult'), ('Active_l1', 'Hosp'), ('Active_l1', 'Adult'), ('IdComponent_l2', 'IdRHospitalizationOrder'), ('Active_l2', 'IdRHospitalizationPrimacy2'), ('Active_l2', 'IdTypeFromDiseaseStart2'), ('Active_l2', 'IdDiagnosisType1'), ('Active_l2', 'IdDiagnosisType2'), ('Active_l2', 'IdRHospResult'), ('Active_l2', 'Hosp'), ('Active_l2', 'Adult'), ('IdRHospitalizationOrder', 'IdRDisabilityDocStatus'), ('IdRHospitalizationPrimacy2', 'IdRDisabilityDocReason'), ('IdRHospitalizationPrimacy2', 'IsPatient'), ('IdStep5', 'IdStep6'), ('IdStep5', 'IdStep7'), ('IdDiseaseType', 'IdRDiseaseType'), ('IdDiagnosedDoctor', 'IDDoctor5'), ('IdDiagnosisType1', 'IdDiagnosisType2'), ('IdDiagnosisType1', 'Parent_Id'), ('IdTraumaType', 'IdRTraumaType2'), ('IdTraumaType', 'IdRTraumaType1'), ('IdRDispensary_State', 'IdRDispensaryState2'), ('IdRDispensary_State', 'Amb'), ('IdRDispensary_State', 'Adult'), ('IdRDiagnosisChangeReason', 'IdCaseType2'), ('IdDiagnosisType2', 'Parent_Id'), ('IdRDispensaryState2', 'Amb'), ('IdRDispensaryState2', 'Adult'), ('IdRTraumaType2', 'IdRTraumaType1'), ('Name15', 'Name18'), ('IdRHospResult', 'IdRDisabilityDocReason'), ('IdRHospResult', 'IsPatient'), ('IdRDisabilityDocReason', 'IsPatient'), ('IdRDisabilityDocReason', 'Amb'), ('IdRDisabilityDocReason', 'Adult'), ('IsPatient', 'Adult'), ('IdServiceType1', 'IdServiceType2'), ('IdStep6', 'IdStep7'), ('Parent_Id', 'Amb'), ('Parent_Id', 'Adult'), ('IdRTFORMSMedicalStandard', 'IdRTFORMSMedicalStandard2')]
result = []
for x,y in mass:
    a = np.where(np.invert(pd.isnull(df.loc[:, y])))
    b = np.where(np.invert(pd.isnull(df.loc[:, x])))
    c = np.intersect1d(a,b)
    result.append(c.size)
